# How to get cazyme profile from 16S amplicon profile



### 0. prerequisite

atlas-utils: [https://github.com/jameslz/atlas-utils](https://github.com/jameslz/atlas-utils)
linkdb: [https://www.genome.jp/linkdb/](https://www.genome.jp/linkdb/)

### download ko-cazy  links

linkdb: [https://www.genome.jp/linkdb/](https://www.genome.jp/linkdb/)

Click database names to download link information between two databases:

From "Orthology" to "Cazy", get `orthology_cazy.list`


```bash
cut -f1,2 orthology_cazy.list | \
  sed  's/ko://; s/cazy://'  >ko-cazy.txt
```

    $ cat ko-cazy.txt | head


    K00516  AA13
    K00516  CBM20
    K00688  GT35
    K00689  GH13
    K00690  GH13
    K00691  GH65
    K00692  GH68
    K00693  GT3
    K00694  GT2
    K00695  GT4


### kann for cazyme profile prediction

`ko.txt` ko profile from `tax4fun` or `picrust2`.

    $ cat  ko.txt | head -n10


    #KO     A-1     A-2     B-1     B-2     C-1     C-2
    K00001  0.000808980004315947    0.000819109861945028    0.000612948680922169    0.000635933480682086    0.000559136968670103    0.000542486474351325
    K00002  7.72038380845697e-06    7.22688422533568e-06    2.49766518305712e-05    1.57502121695051e-05    9.56550887982675e-05    9.858089243293e-05
    K00003  0.000587762479037045    0.000592135220229698    0.000519999878818898    0.000549497183764971    0.000666059282177164    0.000677436021110664
    K00004  1.49014375653928e-05    1.46178664834576e-05    1.85089288332373e-05    2.31926009709905e-05    8.68979017822108e-06    8.51275477401169e-06
    K00005  1.96858905532703e-05    1.86794815743808e-05    9.00123097627357e-05    9.40179323138053e-05    0.00011454456970013     0.000116547766601784
    K00007  1.57188468162294e-06    1.57702545666197e-06    4.306311399988e-05      4.20634852153904e-05    2.03978728434253e-05    1.40124468713644e-05
    K00008  0.000128769240001404    0.000125523931713329    9.53660568009489e-05    9.82964783346064e-05    0.000107892704793437    0.000104476113926683
    K00009  1.18943528760527e-05    1.1045799349361e-05     7.61884286493077e-05    8.46489561836192e-05    2.54266119345416e-05    2.55950032624376e-05
    K00010  0.000310116534051155    0.000303045306800677    0.000224283466136438    0.000235510886152397    0.000265891761696196    0.000264503288754388


```bash
atlas-utils  kann ko-cazy.txt  ko.txt > cazy.txt
```

    $ cat  cazy.txt | head -n 10


    #catalog        A-1     A-2     B-1     B-2     C-1     C-2
    GH32    0.000170459     0.000170748     0.000211951     0.00016806      0.000195005     0.000198242
    GH77    0.000553137     0.000552547     0.000625697     0.000528658     0.000830658     0.000820012
    GH33    9.03383e-05     8.72463e-05     7.27982e-05     3.37224e-05     1.62068e-05     1.89562e-05
    CE10    0.000753469     0.000742246     0.000209153     0.000203359     0.000490099     0.000487653
    GH37    0.000200945     0.000196891     0.000188404     0.000206839     7.18009e-05     6.87244e-05
    GH38    0.000139559     0.000132675     0.000142684     0.000121666     8.17648e-05     7.87227e-05
    CBM15   6.46313e-08     5.29066e-08     8.02831e-06     1.07319e-05     4.69072e-07     5.13717e-07
    GH103   0.000287748     0.000296665     0.000446494     0.000469228     0.000235408     0.000223241
    GT73    5.66048e-07     9.27886e-07     1.97806e-05     2.17107e-05     5.82392e-07     5.81246e-07
